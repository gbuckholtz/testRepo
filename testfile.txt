added some code in the test branch
AND fixed a bug
